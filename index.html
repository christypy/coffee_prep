<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å’–å•¡å‚™é¤ç¢ºèªç³»çµ±</title>
<style>
    :root {
        /* ä¸»è‰²æ¿ */
        --color-primary: #4a3b32; /* æ·±å’–å•¡ */
        --color-accent: #dda15e; /* æ·ºæ£•/é»ƒé‡‘ */
        --color-background: #fcfbf8; /* æŸ”å’Œæ·ºé»ƒèƒŒæ™¯ */
        --color-light-gray: #e9e5e0; 
        --color-done: #f0f0f0; /* å®Œæˆå“çš„èƒŒæ™¯è‰² */
        --color-success: #6c7a42; /* é„°å±…/å®Œæˆé€²åº¦ç¶  */
        --color-danger: #d00000; /* å‰©é¤˜æ•¸ç´…è‰² */
        --color-total-progress: #bc6c25; /* ç¸½è¨ˆé€²åº¦æ©˜ */
    }

    body { 
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto", "Helvetica Neue", "Arial", "Noto Sans TC", sans-serif; 
        background: var(--color-background); 
        padding: 0 10px 20px 10px; 
        color: #333; 
        max-width: 900px;
        margin: 0 auto;
    }
    h2 { 
        text-align: center; 
        color: var(--color-primary); 
        margin: 15px 0 10px 0; 
        font-size: 26px; 
        font-weight: 600;
    }
    
    /* ==== æ‡¸æµ®æ¨™é ­å€å¡Š ==== */
    .sticky-header {
        position: sticky;
        top: 0;
        z-index: 100;
        background: var(--color-background); 
        padding-top: 10px; 
        box-shadow: 0 4px 8px -4px rgba(0, 0, 0, 0.15); 
    }
    
    /* æ§åˆ¶å€ */
    .controls { 
        background: #fff; 
        padding: 12px; 
        border-radius: 12px; 
        box-shadow: 0 1px 3px rgba(0,0,0,0.08); 
        margin-bottom: 15px; 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
    }
    select { 
        padding: 10px; 
        font-size: 16px; 
        border-radius: 8px; 
        border: 1px solid var(--color-light-gray); 
        width: 60%; 
        appearance: none; 
        background-color: #f7f7f7;
    }
    .btn { 
        background: var(--color-accent); 
        color: white; 
        border: none; 
        padding: 10px 14px; 
        border-radius: 8px; 
        cursor: pointer; 
        font-weight: bold; 
        font-size: 15px; 
        transition: background 0.2s;
    }

    /* çµ±è¨ˆå€ */
    .stats-container { 
        display: flex; 
        gap: 15px; 
        margin-bottom: 15px; 
    }
    .stat-box { 
        flex: 1; 
        background: #fff; 
        border-radius: 10px; 
        padding: 10px; 
        box-shadow: 0 3px 6px rgba(0,0,0,0.1); 
        border-top: 5px solid var(--color-primary); 
    }
    .stat-box h3 { 
        margin: 0 0 8px 0; 
        font-size: 15px; 
        color: var(--color-primary); 
        font-weight: 600;
        text-align: center; 
        border-bottom: 1px solid var(--color-light-gray); 
        padding-bottom: 5px;
    }
    
    /* çµ±è¨ˆè¡Œæ¨£å¼ */
    .stat-row { 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        font-size: 14px; 
        margin-bottom: 4px; 
    }
    .stat-row.total { 
        color: var(--color-total-progress); 
        border-top: 1px solid var(--color-light-gray); 
        margin-top: 8px;
        padding-top: 8px;
    }

    /* ==== æ ¸å¿ƒæ”¹å‹•ï¼šé¡¯ç¤ºç¸½æ•¸èˆ‡å‰©é¤˜æ•¸çš„çµæ§‹ START ==== */
    .progress-counts {
        display: flex;
        align-items: center;
        gap: 10px; /* ç¸½è¨ˆèˆ‡å‰©é¤˜ä¹‹é–“çš„é–“è· */
        font-weight: 500;
        font-size: 14px;
    }
    .count-total {
        color: #777;
        /* åœ¨ç¸½è¨ˆè¡Œä¸­ï¼Œç¸½æ•¸ä¸éœ€è¦ç‰¹åˆ¥é¡¯ç¤º */
    }
    .count-remaining {
        display: flex;
        align-items: center;
        gap: 4px; /* å‰©: èˆ‡æ•¸å­—çš„é–“è· */
    }

    /* å€‹åˆ¥é …ç›® */
    .count-remaining b { 
        font-size: 20px; 
        color: var(--color-danger); 
    }

    /* ç¸½è¨ˆè¡Œ */
    .stat-row.total .progress-counts {
        font-size: 16px;
    }
    .stat-row.total .count-remaining b {
        font-size: 22px; 
        color: var(--color-total-progress); /* ç¸½è¨ˆå‰©é¤˜æ•¸ä½¿ç”¨æ©˜è‰² */
    }
    .stat-row.total .count-total {
        color: var(--color-primary); /* ç¸½è¨ˆè¡Œçš„ç¸½æ•¸é¡è‰²æ·±ä¸€é» */
        font-weight: 700;
    }
    /* ==== æ ¸å¿ƒæ”¹å‹•ï¼šé¡¯ç¤ºç¸½æ•¸èˆ‡å‰©é¤˜æ•¸çš„çµæ§‹ END ==== */

    /* é€²åº¦æ¢æ¨£å¼ */
    .stat-row-progress {
        width: 100%;
        height: 6px; 
        background-color: var(--color-light-gray);
        border-radius: 3px;
        margin-bottom: 10px; 
        overflow: hidden;
    }
    .progress-fill { 
        height: 100%; 
        background-color: var(--color-success); 
        transition: width 0.3s ease-in-out; 
    }
    .stat-row.total + .stat-row-progress .progress-fill { 
        background-color: var(--color-total-progress); 
    }


    /* æ¸…å–®å…©æ¬„ä½ˆå±€ */
    #mainListContainer {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 15px;
        margin-bottom: 20px;
    }

    .list-column {
        padding: 10px 10px 0 10px; 
        background: #fff; 
        border-radius: 12px; 
        box-shadow: 0 4px 12px rgba(0,0,0,0.08); 
        border: 1px solid var(--color-light-gray);
    }

    .column-title {
        font-size: 18px;
        font-weight: 700;
        color: var(--color-primary);
        text-align: center;
        padding: 8px 0;
        margin-bottom: 10px;
        border-bottom: 3px solid var(--color-accent); 
    }
    
    /* æ‰‹æ©Ÿä½ˆå±€ */
    @media (max-width: 768px) {
        #mainListContainer {
            grid-template-columns: 1fr; 
        }
    }
    
    /* åˆ—è¡¨å¡ç‰‡ (ç¶­æŒ V14 æ¨£å¼) */
    .card { 
        background: #fff;
        padding: 10px; 
        border-radius: 8px;
        margin-bottom: 8px; 
        border-left: 6px solid #ddd; 
        box-shadow: 0 1px 3px rgba(0,0,0,0.05); 
        display: flex; justify-content: space-between; align-items: center; 
        transition: background 0.1s;
    }
    .card.done { 
        opacity: 0.7; 
        border-left-color: var(--color-light-gray) !important; 
        background: var(--color-done); 
    }
    /*... (å…¶ä»–å¡ç‰‡é¡è‰²å’Œæ–‡å­—æ¨£å¼ä¿æŒä¸è®Š) ...*/

    .item-name { font-weight: 600; font-size: 16px; color: #222; } 
    .item-desc { font-weight: 600; font-size: 15px; color: var(--color-primary); margin-bottom: 0; } 
    .tag { padding: 2px 6px; font-size: 10px; margin-left: 4px; border-radius: 4px; background: #ffe0b2; color: #6d4c41; font-weight: 600; }
    .note-text { font-size: 10px; margin-top: 3px; color: var(--color-danger); font-weight: 600; }
    
    h4 {
        font-size: 15px;
        font-weight: 600;
        color: var(--color-total-progress);
        margin: 12px 0 6px 0 !important;
        border-bottom: 1px dashed var(--color-light-gray);
        padding-bottom: 4px;
        padding-left: 5px;
    }
</style>
</head>
<body>

<h2>â˜• å‚™é¤åŠ©ç†</h2>

<div class="sticky-header">
    <div class="controls">
        <select id="daySelect" onchange="renderOrders()">
            <option value="1">æ˜ŸæœŸä¸€</option>
            <option value="2">æ˜ŸæœŸäºŒ</option>
            <option value="3">æ˜ŸæœŸä¸‰</option>
            <option value="4">æ˜ŸæœŸå››</option>
            <option value="5">æ˜ŸæœŸäº”</option>
            <option value="6">æ˜ŸæœŸå…­</option>
            <option value="0">æ˜ŸæœŸæ—¥</option>
        </select>
        <button class="btn" onclick="renderOrders()">åˆ·æ–°åˆ—è¡¨</button>
    </div>

    <div class="stats-container">
        <div class="stat-box" style="border-top-color: var(--color-success);">
            <h3>ğŸ  å·¦å³é„°å±… ç¸½è¨ˆ</h3>
            <div id="stats-neighbor"></div>
        </div>
        <div class="stat-box" style="border-top-color: var(--color-total-progress);">
            <h3>ğŸ›µ å…¶ä»–å€åŸŸ ç¸½è¨ˆ</h3>
            <div id="stats-other"></div>
        </div>
    </div>
</div>
<div id="mainListContainer">
    <div id="neighborColumn" class="list-column">
        <div class="column-title">ğŸ  å·¦å³é„°å±…è¨‚å–®</div>
        </div>
    <div id="otherColumn" class="list-column">
        <div class="column-title">ğŸ›µ å…¶ä»–å€åŸŸè¨‚å–®</div>
        </div>
</div>

<div class="walk-in-section">
    <h3>ğŸƒ ä¾†åº—å®¢å‚™å¿˜</h3>
    <ul>
        <li><b>çŸ­é«®ç˜¦ç˜¦ï¼š</b>19-23gç²‰ / ç£¨8 (å†°/ç†±ç¾)</li>
        <li><b>ç•¢æ¥­ç”Ÿï¼š</b>å†°ç¾å¼</li>
        <li><b>æˆ´çœ¼é¡å…¬ä¸»é ­ï¼š</b>ç†±æ‹¿éµ</li>
        <li><b>èŠ­æ¨‚ï¼š</b>ç†±æ‹¿éµ + ç³–(3-5g)</li>
    </ul>
</div>

<script>
    // ----------------------------------------------------
    // ã€JS é‚è¼¯å€ã€‘ 
    // ----------------------------------------------------
    const customers = [
        // å³é‚Šé„°å±…
        { loc: "å³é‚Šé„°å±…", name: "æ€¡é¦™è»’", item: "ç†±ç¾å¼", type: "hot_am", days: [] },
        { loc: "å³é‚Šé„°å±…", name: "æ²¹é£¯", item: "ç†±ç¾å¼", type: "hot_am", days: [], note: "æ¯æ—¥å•" },
        { loc: "å³é‚Šé„°å±…", name: "å±±åŸç±³é£Ÿ", item: "æ‹¿éµ", type: "hot_latte", days: [], tag: "å¯„æ¯" }, 
        { loc: "å³é‚Šé„°å±…", name: "æ©˜å­æ”¤", item: "æ‹¿éµ", type: "hot_latte", days: [] }, 
        { loc: "å³é‚Šé„°å±…", name: "ç³–æœ", item: "ç†±æ‹¿éµ", type: "hot_latte", days: [6, 0], tag: "ä»˜å…©å¤©" },

        // å·¦é‚Šé„°å±…
        { loc: "å·¦é‚Šé„°å±…", name: "å¸ƒè€é—†", item: "ç†±ç¾å¼", type: "hot_am", days: [5], tag: "å¯„æ¯" },
        { loc: "å·¦é‚Šé„°å±…", name: "ç‰›è‚‰", item: "ç†±æ‹¿éµ", type: "hot_latte", days: [3, 5, 0], tag: "+3gç³–" },
        { loc: "å·¦é‚Šé„°å±…", name: "ç”˜è”—é›", item: "å†°ç¾å¼", type: "ice_am", days: [] },
        { loc: "å·¦é‚Šé„°å±…", name: "åœ‹è¯å“¥", item: "å†°ç¾å¼", type: "ice_am", days: [] },

        // å…¶ä»–å€åŸŸ
        { loc: "è¿‘åå­—è·¯å£", name: "ç‰›è‚‰çˆ¸çˆ¸å…’å­", item: "å¤§æ‹¿éµ x2", count: 2, type: "large_hot_latte", days: [], note: "çˆ¸çˆ¸ç²‰20g" },
        { loc: "éåå­—è·¯å£ç›´è¡Œ", name: "é­šè€é—†", item: "å¤§æ‹¿éµ", type: "large_hot_latte", days: [2, 3, 5], tag: "å¯„æ¯" },
        { loc: "éåå­—è·¯å£ç›´è¡Œ", name: "é­šè€é—†é„°å±…(æ°´æœ)", item: "æ‹¿éµ", type: "hot_latte", days: [2, 3, 6, 0] }, 
        { loc: "éåå­—è·¯å£ç›´è¡Œ", name: "å°è¾£æ¤’", item: "ç†±ç¾å¼", type: "hot_am", days: [] },
        { loc: "éåå­—è·¯å£ç›´è¡Œ", name: "è¦è€é—†", item: "ç†±ç¾å¼", type: "hot_am", days: [2, 4, 5, 6, 0] },
        
        // è²¢ä¸¸è€é—†ï¼šå°‡é€™å…©ç­†è³‡æ–™è¦–ç‚ºä¸€çµ„é€²è¡Œåˆä½µæ¸²æŸ“
        { loc: "éåå­—è·¯å£ç›´è¡Œ", name: "è²¢ä¸¸è€é—† (æ‹¿)", item: "ç†±æ‹¿éµ", type: "hot_latte", days: [3, 0] },
        { loc: "éåå­—è·¯å£ç›´è¡Œ", name: "è²¢ä¸¸è€é—† (æ‰‹)", item: "ç†±æ‰‹æ²–", type: "hand_drip", days: [3, 0], note: "ç¸½è¨ˆ$185" },
        
        { loc: "éåå­—è·¯å£ç›´è¡Œ", name: "è±åŸç´ é£Ÿ", item: "ç†±ç¾å¼", type: "hot_am", days: [3] },
        { loc: "éåå­—è·¯å£ç›´è¡Œ", name: "èœè€é—†", item: "ç†±æ‹¿éµ", type: "hot_latte", days: [] },
        { loc: "éåå­—è·¯å£ç›´è¡Œ", name: "è¿‘ä¸­å±±è·¯æ°´æœæ”¤", item: "ç†±ç¾å¼", type: "hot_am", days: [] },
        { loc: "éåå­—è·¯å£å³è½‰", name: "ç¦è¨˜å°é¢è±¬è‚‰", item: "ç†±ç¾å¼", type: "hot_am", days: [], tag: "å¯„æ¯" }
    ];

    const typeNames = {
        hot_am: 'â˜• ç†±ç¾å¼', ice_am: 'ğŸ§Š å†°ç¾å¼', hot_latte: 'ğŸ”¥ ç†±æ‹¿éµ', 
        ice_latte: 'â„ï¸ å†°æ‹¿éµ', large_hot_latte: 'ğŸ¥¤ å¤§ç†±æ‹¿', hand_drip: 'ğŸ’§ æ‰‹æ²–',
    };

    function getTodayDateString() {
        const today = new Date();
        const yyyy = today.getFullYear().toString();
        const mm = (today.getMonth() + 1).toString().padStart(2, '0');
        const dd = today.getDate().toString().padStart(2, '0');
        return yyyy + mm + dd;
    }

    function sanitizeKeyPart(s) {
        if (!s) return '';
        return s.replace(/[^a-zA-Z0-9\u4e00-\u9fa5_]/g, ''); 
    }

    function getStorageKey(name, item, loc) {
        return `${getTodayDateString()}_${sanitizeKeyPart(name)}_${sanitizeKeyPart(item)}_${sanitizeKeyPart(loc)}`;
    }

    function escapeJsString(s) {
        if (!s) return '';
        return s.replace(/\\/g, '\\\\') 
                .replace(/'/g, '\\\'');
    }

    window.toggleDone = function(name, item, loc) {
        const key = getStorageKey(name, item, loc);
        const isDone = localStorage.getItem(key) === 'true';
        
        if (isDone) {
            localStorage.removeItem(key); 
        } else {
            localStorage.setItem(key, 'true'); 
        }
        renderOrders();
    }

    function isItemDone(name, item, loc) {
        const key = getStorageKey(name, item, loc);
        return localStorage.getItem(key) === 'true';
    }
    
    // --------------------------------------------------
    // ã€æ ¸å¿ƒé‚è¼¯ï¼šæ¸…å–®æ¸²æŸ“ã€‘
    // --------------------------------------------------
    function renderOrders() {
        const day = parseInt(document.getElementById('daySelect').value);
        const neighborColumn = document.getElementById('neighborColumn');
        const otherColumn = document.getElementById('otherColumn');
        const statsNeighborDiv = document.getElementById('stats-neighbor');
        const statsOtherDiv = document.getElementById('stats-other');
        
        // V15.0 æ–°å¢: è™•ç†å›ºå®šä¼‘æ¯æ—¥ (æ˜ŸæœŸä¸€)
        if (day === 1) { 
            const restHtml = '<p style="text-align:center; color:var(--color-danger); font-size:18px; padding: 50px 0;">ğŸ‰ æ˜ŸæœŸä¸€å›ºå®šä¼‘æ¯æ—¥ï¼Œç„¡å‚™é¤è¨‚å–®ï¼</p>';
            neighborColumn.innerHTML = `<div class="column-title">ğŸ  å·¦å³é„°å±…è¨‚å–®</div>${restHtml}`;
            otherColumn.innerHTML = `<div class="column-title">ğŸ›µ å…¶ä»–å€åŸŸè¨‚å–®</div>`;
            statsNeighborDiv.innerHTML = '<div style="text-align:center;color:#999;font-size:12px;">ä¼‘æ¯ä¸­</div>';
            statsOtherDiv.innerHTML = '<div style="text-align:center;color:#999;font-size:12px;">ä¼‘æ¯ä¸­</div>';
            return; // çµ‚æ­¢å¾ŒçºŒçš„æ¸²æŸ“å’Œçµ±è¨ˆé‚è¼¯
        }
        // ------------------------------------

        neighborColumn.innerHTML = `<div class="column-title">ğŸ  å·¦å³é„°å±…è¨‚å–®</div>`;
        otherColumn.innerHTML = `<div class="column-title">ğŸ›µ å…¶ä»–å€åŸŸè¨‚å–®</div>`;

        
        const initialStatsTemplate = { total: 0, done: 0 };
        const initialStats = {};
        for (const key in typeNames) {
            initialStats[key] = { ...initialStatsTemplate };
        }

        let sNeigh = JSON.parse(JSON.stringify(initialStats));
        let sOther = JSON.parse(JSON.stringify(initialStats));

        const todaysOrders = customers.filter(c => c.days.length === 0 || c.days.includes(day));

        // éšæ®µä¸€ï¼šå»ºç«‹æœ€çµ‚çš„æ¸²æŸ“åˆ—è¡¨ (è™•ç†åˆä½µ)
        const finalOrders = [];
        let i = 0;
        while (i < todaysOrders.length) {
            let c = todaysOrders[i];
            
            if (c.name === "è²¢ä¸¸è€é—† (æ‹¿)" && i + 1 < todaysOrders.length && todaysOrders[i + 1].name === "è²¢ä¸¸è€é—† (æ‰‹)") {
                let c2 = todaysOrders[i + 1];
                
                finalOrders.push({
                    loc: c.loc,
                    name: "è²¢ä¸¸è€é—†", 
                    type: "multi", 
                    note: c2.note || c.note, 
                    originalItems: [
                        { name: c.name, item: c.item, type: c.type, loc: c.loc, count: c.count || 1, tag: c.tag },
                        { name: c2.name, item: c2.item, type: c2.type, loc: c2.loc, count: c2.count || 1, tag: c2.tag }
                    ]
                });
                i += 2; 
            } else {
                finalOrders.push(c);
                i++;
            }
        }
        
        // éšæ®µäºŒï¼šçµ±è¨ˆèˆ‡æ¸²æŸ“
        let neighborHtml = '';
        let otherHtml = '';
        let currentNeighborLoc = ''; 
        let currentOtherLoc = '';    


        finalOrders.forEach((c) => {
            let itemsToRender = [];
            
            if (c.type === "multi" && c.originalItems) {
                itemsToRender = c.originalItems;
                c.cardClass = 'multi';
            } else {
                itemsToRender = [c];
                let cardClass = '';
                if(c.type && c.type.includes('am')) cardClass = 'americano';
                else if(c.type && c.type.includes('latte')) cardClass = 'latte';
                else if(c.type && c.type.includes('drip')) cardClass = 'drip';
                c.cardClass = cardClass;
            }

            // åŸ·è¡Œçµ±è¨ˆ
            itemsToRender.forEach(item => {
                let qty = item.count || 1;
                let isNeighbor = (item.loc === "å³é‚Šé„°å±…" || item.loc === "å·¦é‚Šé„°å±…");
                let targetStats = isNeighbor ? sNeigh : sOther;
                const isDone = isItemDone(item.name, item.item, item.loc);

                if (targetStats[item.type]) {
                    targetStats[item.type].total += qty;
                    if (isDone) {
                        targetStats[item.type].done += qty;
                    }
                }
            });

            // æ¸²æŸ“åˆ—è¡¨
            let targetHtml = '';
            let targetCurrentLoc = '';

            const isNeighbor = (c.loc === "å³é‚Šé„°å±…" || c.loc === "å·¦é‚Šé„°å±…");
            
            if (isNeighbor) {
                targetHtml = neighborHtml;
                targetCurrentLoc = currentNeighborLoc;
            } else {
                targetHtml = otherHtml;
                targetCurrentLoc = currentOtherLoc;
            }

            // åŠ ä¸Šä½ç½®å°æ¨™é¡Œ
            if (c.loc !== targetCurrentLoc) {
                targetHtml += `<h4>${c.loc}</h4>`;
                targetCurrentLoc = c.loc;
            }

            // æ¸²æŸ“å¡ç‰‡
            let tagsHtml = c.tag ? `<span class="tag tag-pre">${c.tag}</span>` : '';
            let noteHtml = c.note ? `<span class="note-text">âš ï¸ ${c.note}</span>` : '';

            if (c.type !== "multi") {
                const isDone = isItemDone(c.name, c.item, c.loc);
                const doneClass = isDone ? 'done' : '';
                const checkedAttr = isDone ? 'checked' : '';
                const safeName = escapeJsString(c.name);
                const safeItem = escapeJsString(c.item);
                const safeLoc = escapeJsString(c.loc);

                targetHtml += `
                    <div class="card ${c.cardClass} ${doneClass}">
                        <div class="info-col">
                            <div class="item-name">${c.name} ${tagsHtml}</div>
                            <div class="item-detail">${noteHtml}</div>
                        </div>
                        <div class="right-col">
                            <div class="item-desc">${c.item}</div>
                            <input type="checkbox" ${checkedAttr} onclick="toggleDone('${safeName}', '${safeItem}', '${safeLoc}')">
                        </div>
                    </div>
                `;
            } else {
                let allDone = c.originalItems.every(item => isItemDone(item.name, item.item, item.loc));
                const doneClass = allDone ? 'done' : '';
                let itemDescHtml = c.originalItems.map(item => item.item).join(' | ');

                let checkboxHtml = c.originalItems.map(item => {
                    const isDone = isItemDone(item.name, item.item, item.loc);
                    const checkedAttr = isDone ? 'checked' : '';
                    const safeName = escapeJsString(item.name);
                    const safeItem = escapeJsString(item.item);
                    const safeLoc = escapeJsString(item.loc);
                    
                    return `
                        <div style="display:flex; align-items:center; justify-content:flex-end; font-size:12px;">
                            <span style="margin-right:5px; color:#555;">${item.item.replace('ç†±', '').replace('å¤§', '')}</span>
                            <input type="checkbox" ${checkedAttr} onclick="toggleDone('${safeName}', '${safeItem}', '${safeLoc}')">
                        </div>
                    `;
                }).join('');

                targetHtml += `
                    <div class="card ${c.cardClass} ${doneClass}">
                        <div class="info-col">
                            <div class="item-name">${c.name} ${tagsHtml}</div>
                            <div class="item-detail">${noteHtml}</div>
                        </div>
                        <div class="right-col">
                            <div class="item-multi-display">
                                <div class="item-desc">${itemDescHtml}</div>
                                <div style="display:flex; gap:10px;">${checkboxHtml}</div>
                            </div>
                        </div>
                    </div>
                `;
            }

            if (isNeighbor) {
                neighborHtml = targetHtml;
                currentNeighborLoc = targetCurrentLoc;
            } else {
                otherHtml = targetHtml;
                currentOtherLoc = targetCurrentLoc;
            }
        });

        // å¯¦éš›æ¸²æŸ“åˆ° DOM
        neighborColumn.innerHTML += neighborHtml;
        otherColumn.innerHTML += otherHtml;
        
        if (neighborHtml === '') neighborColumn.innerHTML += '<p style="text-align:center;color:#999;font-size:12px; margin-top: 20px;">ä»Šæ—¥é„°å±…ç„¡å›ºå®šè¨‚å–®</p>';
        if (otherHtml === '') otherColumn.innerHTML += '<p style="text-align:center;color:#999;font-size:12px; margin-top: 20px;">ä»Šæ—¥å…¶ä»–å€åŸŸç„¡å›ºå®šè¨‚å–®</p>';


        // ç”¢ç”Ÿçµ±è¨ˆ HTML (å·²ä¿®æ”¹ç‚ºé¡¯ç¤ºç¸½æ•¸èˆ‡å‰©é¤˜æ•¸)
        function makeStatHtml(stats) {
            let html = '';
            let totalCupsNeeded = 0;
            let totalCupsDone = 0;
            
            for (const typeKey in typeNames) {
                const itemStats = stats[typeKey];
                if (itemStats.total > 0) {
                    const remaining = itemStats.total - itemStats.done;
                    const percent = Math.round((itemStats.done / itemStats.total) * 100);
                    
                    const remainingColor = remaining === 0 ? 'color: var(--color-success);' : '';

                    // å–®å“é …çµ±è¨ˆè¡Œ
                    html += `
                        <div class="stat-row">
                            <span>${typeNames[typeKey]}</span> 
                            <div class="progress-counts">
                                <span class="count-total">ç¸½è¨ˆ: ${itemStats.total}</span>
                                <span class="count-remaining">å‰©: <b style="${remainingColor}">${remaining}</b></span>
                            </div>
                        </div>
                        <div class="stat-row-progress">
                            <div class="progress-fill" style="width: ${percent}%;"></div>
                        </div>
                    `;
                    totalCupsNeeded += itemStats.total;
                    totalCupsDone += itemStats.done;
                }
            }
            
            if(totalCupsNeeded > 0) {
                const totalRemaining = totalCupsNeeded - totalCupsDone;
                const totalPercent = Math.round((totalCupsDone / totalCupsNeeded) * 100);

                // ç¸½è¨ˆçµ±è¨ˆè¡Œ
                html += `<div class="stat-row total">
                            <span>ğŸ† ç¸½è¨ˆ</span> 
                            <div class="progress-counts">
                                <span class="count-total">ç¸½è¨ˆ: ${totalCupsNeeded}</span>
                                <span class="count-remaining">å‰©: <b>${totalRemaining}</b></span>
                            </div>
                         </div>
                         <div class="stat-row-progress">
                            <div class="progress-fill" style="width: ${totalPercent}%;"></div>
                         </div>
                `;
            } else {
                 html = '<div style="text-align:center;color:#999;font-size:12px;">ç„¡è¨‚å–®çµ±è¨ˆ</div>';
            }
            return html;
        }

        statsNeighborDiv.innerHTML = makeStatHtml(sNeigh);
        statsOtherDiv.innerHTML = makeStatHtml(sOther);
    }

    /**
     * åˆå§‹åŒ–ï¼šè‡ªå‹•é¸æ“‡ä»Šå¤©æ˜ŸæœŸå¹¾ (0=é€±æ—¥, 1=é€±ä¸€... 6=é€±å…­)
     */
    const today = new Date().getDay(); 
    document.getElementById('daySelect').value = today;
    renderOrders();

</script>
</body>
</html>